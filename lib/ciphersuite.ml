
type key_exchange_algorithm =
  | NULL
  | RSA
  | DH_DSS
  | DH_RSA
  | DHE_DSS
  | DHE_RSA
  | DH_anon
  | PSK
  | DHE_PSK
  | RSA_PSK
  | ECDHE_PSK
  | ECDH_ECDSA
  | ECDHE_ECDSA
  | ECDH_RSA
  | ECDHE_RSA
  | ECDH_anon
  | KRB5
  | SRP_SHA
  | SRP_SHA_RSA
  | SRP_SHA_DSS

let needs_certificate = function
  | DH_anon | PSK -> false
  | _ -> true

let needs_server_kex = function
  | DHE_DSS | DHE_RSA
  | DH_anon
  | ECDHE_ECDSA | ECDHE_RSA
  | ECDH_anon | ECDH_ECDSA | ECDH_RSA -> true

  | RSA | DH_DSS | DH_RSA -> false

type encryption_algorithm =
  | NULL
  | RC4_40
  | RC4_128
  | RC2_40_CBC
  | IDEA_CBC
  | DES_40_CBC
  | DES_CBC
  | TRIPLE_DES_EDE_CBC
  | AES_128_CBC
  | AES_256_CBC
  | AES_128_GCM
  | AES_256_GCM
  | AES_128_CCM
  | AES_256_CCM
  | AES_128_CCM_8
  | AES_256_CCM_8
  | CAMELLIA_128_CBC
  | CAMELLIA_256_CBC
  | CAMELLIA_128_GCM
  | CAMELLIA_256_GCM
  | SEED_CBC
  | ARIA_128_GCM
  | ARIA_256_GCM
  | ARIA_128_CBC
  | ARIA_256_CBC

(* encryption_algorithm ->
   (key_material          : int -- bytes from key_block to generate write keys
    iv_size               : int -- length of IV, 0 for stream ciphers *)
let key_lengths = function
  | IDEA_CBC -> (16, 8)
  | RC4_128 -> (16, 0)
  | TRIPLE_DES_EDE_CBC -> (24, 8)
  | SEED_CBC -> (16, 16)
  | AES_128_CBC -> (16, 16)
  | AES_256_CBC -> (32, 16)
(*  | AES_128_GCM
  | AES_256_GCM
  | AES_128_CCM
  | AES_256_CCM
  | AES_128_CCM_8
  | AES_256_CCM_8 *)
  | CAMELLIA_128_CBC -> (16, 16)
  | CAMELLIA_256_CBC -> (32, 16)
(*  | CAMELLIA_128_GCM
  | CAMELLIA_256_GCM
  | ARIA_128_GCM
  | ARIA_256_GCM
  | ARIA_128_CBC
  | ARIA_256_CBC *)

type hash_algorithm =
  | NULL
  | MD5
  | SHA
  | SHA224
  | SHA256
  | SHA384
  | SHA512

let asn_to_hash_algorithm a =
  let module A = Asn_grammars.Algorithm in
  match a with
  | A.MD5    -> Some MD5
  | A.SHA1   -> Some SHA
  | A.SHA224 -> Some SHA224
  | A.SHA256 -> Some SHA256
  | A.SHA384 -> Some SHA384
  | A.SHA512 -> Some SHA512
  | _        -> None

let hash_algorithm_to_asn h =
  let module A = Asn_grammars.Algorithm in
  match h with
  | MD5    -> Some A.MD5
  | SHA    -> Some A.SHA1
  | SHA224 -> Some A.SHA224
  | SHA256 -> Some A.SHA256
  | SHA384 -> Some A.SHA384
  | SHA512 -> Some A.SHA512
  | _      -> None

(* TLS ciphersuites *)
cenum ciphersuite {
  TLS_NULL_WITH_NULL_NULL                = 0x0000;
  TLS_RSA_WITH_NULL_MD5                  = 0x0001;
  TLS_RSA_WITH_NULL_SHA                  = 0x0002;
  TLS_RSA_EXPORT_WITH_RC4_40_MD5         = 0x0003;
  TLS_RSA_WITH_RC4_128_MD5               = 0x0004;
  TLS_RSA_WITH_RC4_128_SHA               = 0x0005;
  TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5     = 0x0006;
  TLS_RSA_WITH_IDEA_CBC_SHA              = 0x0007;
  TLS_RSA_EXPORT_WITH_DES40_CBC_SHA      = 0x0008;
  TLS_RSA_WITH_DES_CBC_SHA               = 0x0009;
  TLS_RSA_WITH_3DES_EDE_CBC_SHA          = 0x000A;
  TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA   = 0x000B;
  TLS_DH_DSS_WITH_DES_CBC_SHA            = 0x000C;
  TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA       = 0x000D;
  TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA   = 0x000E;
  TLS_DH_RSA_WITH_DES_CBC_SHA            = 0x000F;
  TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA       = 0x0010;
  TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA  = 0x0011;
  TLS_DHE_DSS_WITH_DES_CBC_SHA           = 0x0012;
  TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA      = 0x0013;
  TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA  = 0x0014;
  TLS_DHE_RSA_WITH_DES_CBC_SHA           = 0x0015;
  TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA      = 0x0016;
  TLS_DH_anon_EXPORT_WITH_RC4_40_MD5     = 0x0017;
  TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA  = 0x0019;
  (* MITM deprecated *)
  TLS_DH_anon_WITH_RC4_128_MD5        = 0x0018;
  TLS_DH_anon_WITH_DES_CBC_SHA        = 0x001A;
  TLS_DH_anon_WITH_3DES_EDE_CBC_SHA   = 0x001B;
  RESERVED_SSL3_1                     = 0x001C; (* RFC5246 *)
  RESERVED_SSL3_2                     = 0x001D; (* RFC5246 *)
  TLS_KRB5_WITH_DES_CBC_SHA           = 0x001E; (* RFC2712 *)
  TLS_KRB5_WITH_3DES_EDE_CBC_SHA      = 0x001F; (* RFC2712 *)
  TLS_KRB5_WITH_RC4_128_SHA           = 0x0020; (*RFC2712 RFC6347*)
  TLS_KRB5_WITH_IDEA_CBC_SHA          = 0x0021; (*RFC2712*)
  TLS_KRB5_WITH_DES_CBC_MD5           = 0x0022; (*RFC2712*)
  TLS_KRB5_WITH_3DES_EDE_CBC_MD5      = 0x0023; (*RFC2712*)
  TLS_KRB5_WITH_RC4_128_MD5           = 0x0024; (*RFC2712, RFC6347*)
  TLS_KRB5_WITH_IDEA_CBC_MD5          = 0x0025; (*RFC2712*)
  TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA = 0x0026; (*RFC2712*)
  TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA = 0x0027; (*RFC2712*)
  TLS_KRB5_EXPORT_WITH_RC4_40_SHA     = 0x0028; (*RFC2712, RFC6347*)
  TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5 = 0x0029; (*RFC2712*)
  TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5 = 0x002A; (*RFC2712*)
  TLS_KRB5_EXPORT_WITH_RC4_40_MD5     = 0x002B; (*RFC2712, RFC6347*)
  TLS_PSK_WITH_NULL_SHA               = 0x002C; (*RFC4785*)
  TLS_DHE_PSK_WITH_NULL_SHA           = 0x002D; (*RFC4785*)
  TLS_RSA_PSK_WITH_NULL_SHA           = 0x002E; (*RFC4785*)
  (* from RFC 3268 *)
  TLS_RSA_WITH_AES_128_CBC_SHA      = 0x002F;
  TLS_DH_DSS_WITH_AES_128_CBC_SHA   = 0x0030;
  TLS_DH_RSA_WITH_AES_128_CBC_SHA   = 0x0031;
  TLS_DHE_DSS_WITH_AES_128_CBC_SHA  = 0x0032;
  TLS_DHE_RSA_WITH_AES_128_CBC_SHA  = 0x0033;
  TLS_DH_anon_WITH_AES_128_CBC_SHA  = 0x0034;
  TLS_RSA_WITH_AES_256_CBC_SHA      = 0x0035;
  TLS_DH_DSS_WITH_AES_256_CBC_SHA   = 0x0036;
  TLS_DH_RSA_WITH_AES_256_CBC_SHA   = 0x0037;
  TLS_DHE_DSS_WITH_AES_256_CBC_SHA  = 0x0038;
  TLS_DHE_RSA_WITH_AES_256_CBC_SHA  = 0x0039;
  TLS_DH_anon_WITH_AES_256_CBC_SHA  = 0x003A;
  (* from RFC 5246 *)
  TLS_RSA_WITH_NULL_SHA256                 = 0x003B;
  TLS_RSA_WITH_AES_128_CBC_SHA256          = 0x003C;
  TLS_RSA_WITH_AES_256_CBC_SHA256          = 0x003D;
  TLS_DH_DSS_WITH_AES_128_CBC_SHA256       = 0x003E;
  TLS_DH_RSA_WITH_AES_128_CBC_SHA256       = 0x003F;
  TLS_DHE_DSS_WITH_AES_128_CBC_SHA256      = 0x0040;
  TLS_RSA_WITH_CAMELLIA_128_CBC_SHA        = 0x0041; (*RFC5932*)
  TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA     = 0x0042; (*RFC5932*)
  TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA     = 0x0043; (*RFC5932*)
  TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA    = 0x0044; (*RFC5932*)
  TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA    = 0x0045; (*RFC5932*)
  TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA    = 0x0046; (*RFC5932*)
  TLS_DHE_RSA_WITH_AES_128_CBC_SHA256      = 0x0067;
  TLS_DH_DSS_WITH_AES_256_CBC_SHA256       = 0x0068;
  TLS_DH_RSA_WITH_AES_256_CBC_SHA256       = 0x0069;
  TLS_DHE_DSS_WITH_AES_256_CBC_SHA256      = 0x006A;
  TLS_DHE_RSA_WITH_AES_256_CBC_SHA256      = 0x006B;
  TLS_DH_anon_WITH_AES_128_CBC_SHA256      = 0x006C;
  TLS_DH_anon_WITH_AES_256_CBC_SHA256      = 0x006D;
  TLS_RSA_WITH_CAMELLIA_256_CBC_SHA        = 0x0084; (*RFC5932*)
  TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA     = 0x0085; (*RFC5932*)
  TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA     = 0x0086; (*RFC5932*)
  TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA    = 0x0087; (*RFC5932*)
  TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA    = 0x0088; (*RFC5932*)
  TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA    = 0x0089; (*RFC5932*)
  TLS_PSK_WITH_RC4_128_SHA                 = 0x008A; (*RFC4279, RFC6347*)
  TLS_PSK_WITH_3DES_EDE_CBC_SHA            = 0x008B; (*RFC4279*)
  TLS_PSK_WITH_AES_128_CBC_SHA             = 0x008C; (*RFC4279*)
  TLS_PSK_WITH_AES_256_CBC_SHA             = 0x008D; (*RFC4279*)
  TLS_DHE_PSK_WITH_RC4_128_SHA             = 0x008E; (*RFC4279, RFC6347*)
  TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA        = 0x008F; (*RFC4279*)
  TLS_DHE_PSK_WITH_AES_128_CBC_SHA         = 0x0090; (*RFC4279*)
  TLS_DHE_PSK_WITH_AES_256_CBC_SHA         = 0x0091; (*RFC4279*)
  TLS_RSA_PSK_WITH_RC4_128_SHA             = 0x0092; (*RFC4279, RFC6347*)
  TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA        = 0x0093; (*RFC4279*)
  TLS_RSA_PSK_WITH_AES_128_CBC_SHA         = 0x0094; (*RFC4279*)
  TLS_RSA_PSK_WITH_AES_256_CBC_SHA         = 0x0095; (*RFC4279*)
  TLS_RSA_WITH_SEED_CBC_SHA                = 0x0096; (*RFC4162*)
  TLS_DH_DSS_WITH_SEED_CBC_SHA             = 0x0097; (*RFC4162*)
  TLS_DH_RSA_WITH_SEED_CBC_SHA             = 0x0098; (*RFC4162*)
  TLS_DHE_DSS_WITH_SEED_CBC_SHA            = 0x0099; (*RFC4162*)
  TLS_DHE_RSA_WITH_SEED_CBC_SHA            = 0x009A; (*RFC4162*)
  TLS_DH_anon_WITH_SEED_CBC_SHA            = 0x009B; (*RFC4162*)
  TLS_RSA_WITH_AES_128_GCM_SHA256          = 0x009C; (*RFC5288*)
  TLS_RSA_WITH_AES_256_GCM_SHA384          = 0x009D; (*RFC5288*)
  TLS_DHE_RSA_WITH_AES_128_GCM_SHA256      = 0x009E; (*RFC5288*)
  TLS_DHE_RSA_WITH_AES_256_GCM_SHA384      = 0x009F; (*RFC5288*)
  TLS_DH_RSA_WITH_AES_128_GCM_SHA256       = 0x00A0; (*RFC5288*)
  TLS_DH_RSA_WITH_AES_256_GCM_SHA384       = 0x00A1; (*RFC5288*)
  TLS_DHE_DSS_WITH_AES_128_GCM_SHA256      = 0x00A2; (*RFC5288*)
  TLS_DHE_DSS_WITH_AES_256_GCM_SHA384      = 0x00A3; (*RFC5288*)
  TLS_DH_DSS_WITH_AES_128_GCM_SHA256       = 0x00A4; (*RFC5288*)
  TLS_DH_DSS_WITH_AES_256_GCM_SHA384       = 0x00A5; (*RFC5288*)
  TLS_DH_anon_WITH_AES_128_GCM_SHA256      = 0x00A6; (*RFC5288*)
  TLS_DH_anon_WITH_AES_256_GCM_SHA384      = 0x00A7; (*RFC5288*)
  TLS_PSK_WITH_AES_128_GCM_SHA256          = 0x00A8; (*RFC5487*)
  TLS_PSK_WITH_AES_256_GCM_SHA384          = 0x00A9; (*RFC5487*)
  TLS_DHE_PSK_WITH_AES_128_GCM_SHA256      = 0x00AA; (*RFC5487*)
  TLS_DHE_PSK_WITH_AES_256_GCM_SHA384      = 0x00AB; (*RFC5487*)
  TLS_RSA_PSK_WITH_AES_128_GCM_SHA256      = 0x00AC; (*RFC5487*)
  TLS_RSA_PSK_WITH_AES_256_GCM_SHA384      = 0x00AD; (*RFC5487*)
  TLS_PSK_WITH_AES_128_CBC_SHA256          = 0x00AE; (*RFC5487*)
  TLS_PSK_WITH_AES_256_CBC_SHA384          = 0x00AF; (*RFC5487*)
  TLS_PSK_WITH_NULL_SHA256                 = 0x00B0; (*RFC5487*)
  TLS_PSK_WITH_NULL_SHA384                 = 0x00B1; (*RFC5487*)
  TLS_DHE_PSK_WITH_AES_128_CBC_SHA256      = 0x00B2; (*RFC5487*)
  TLS_DHE_PSK_WITH_AES_256_CBC_SHA384      = 0x00B3; (*RFC5487*)
  TLS_DHE_PSK_WITH_NULL_SHA256             = 0x00B4; (*RFC5487*)
  TLS_DHE_PSK_WITH_NULL_SHA384             = 0x00B5; (*RFC5487*)
  TLS_RSA_PSK_WITH_AES_128_CBC_SHA256      = 0x00B6; (*RFC5487*)
  TLS_RSA_PSK_WITH_AES_256_CBC_SHA384      = 0x00B7; (*RFC5487*)
  TLS_RSA_PSK_WITH_NULL_SHA256             = 0x00B8; (*RFC5487*)
  TLS_RSA_PSK_WITH_NULL_SHA384             = 0x00B9; (*RFC5487*)
  TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256     = 0x00BA; (*RFC5932*)
  TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256  = 0x00BB; (*RFC5932*)
  TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256  = 0x00BC; (*RFC5932*)
  TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256 = 0x00BD; (*RFC5932*)
  TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 = 0x00BE; (*RFC5932*)
  TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256 = 0x00BF; (*RFC5932*)
  TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256     = 0x00C0; (*RFC5932*)
  TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256  = 0x00C1; (*RFC5932*)
  TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256  = 0x00C2; (*RFC5932*)
  TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256 = 0x00C3; (*RFC5932*)
  TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256 = 0x00C4; (*RFC5932*)
  TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA256 = 0x00C5; (*RFC5932*)
  TLS_EMPTY_RENEGOTIATION_INFO_SCSV        = 0x00FF; (*RFC5746*)
  (* from RFC 4492 *)
  TLS_ECDH_ECDSA_WITH_NULL_SHA                 = 0xC001;
  TLS_ECDH_ECDSA_WITH_RC4_128_SHA              = 0xC002;
  TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA         = 0xC003;
  TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA          = 0xC004;
  TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA          = 0xC005;
  TLS_ECDHE_ECDSA_WITH_NULL_SHA                = 0xC006;
  TLS_ECDHE_ECDSA_WITH_RC4_128_SHA             = 0xC007;
  TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA        = 0xC008;
  TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA         = 0xC009;
  TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA         = 0xC00A;
  TLS_ECDH_RSA_WITH_NULL_SHA                   = 0xC00B;
  TLS_ECDH_RSA_WITH_RC4_128_SHA                = 0xC00C;
  TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA           = 0xC00D;
  TLS_ECDH_RSA_WITH_AES_128_CBC_SHA            = 0xC00E;
  TLS_ECDH_RSA_WITH_AES_256_CBC_SHA            = 0xC00F;
  TLS_ECDHE_RSA_WITH_NULL_SHA                  = 0xC010;
  TLS_ECDHE_RSA_WITH_RC4_128_SHA               = 0xC011;
  TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA          = 0xC012;
  TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA           = 0xC013;
  TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA           = 0xC014;
  TLS_ECDH_anon_WITH_NULL_SHA                  = 0xC015;
  TLS_ECDH_anon_WITH_RC4_128_SHA               = 0xC016;
  TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA          = 0xC017;
  TLS_ECDH_anon_WITH_AES_128_CBC_SHA           = 0xC018;
  TLS_ECDH_anon_WITH_AES_256_CBC_SHA           = 0xC019;
  TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA            = 0xC01A; (*RFC5054*)
  TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA        = 0xC01B; (*RFC5054*)
  TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA        = 0xC01C; (*RFC5054*)
  TLS_SRP_SHA_WITH_AES_128_CBC_SHA             = 0xC01D; (*RFC5054*)
  TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA         = 0xC01E; (*RFC5054*)
  TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA         = 0xC01F; (*RFC5054*)
  TLS_SRP_SHA_WITH_AES_256_CBC_SHA             = 0xC020; (*RFC5054*)
  TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA         = 0xC021; (*RFC5054*)
  TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA         = 0xC022; (*RFC5054*)
  TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256      = 0xC023; (*RFC5289*)
  TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384      = 0xC024; (*RFC5289*)
  TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256       = 0xC025; (*RFC5289*)
  TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384       = 0xC026; (*RFC5289*)
  TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256        = 0xC027; (*RFC5289*)
  TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384        = 0xC028; (*RFC5289*)
  TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256         = 0xC029; (*RFC5289*)
  TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384         = 0xC02A;  (*RFC5289*)
  TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256      = 0xC02B; (*RFC5289*)
  TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384      = 0xC02C; (*RFC5289*)
  TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256       = 0xC02D; (*RFC5289*)
  TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384       = 0xC02E; (*RFC5289*)
  TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256        = 0xC02F; (*RFC5289*)
  TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384        = 0xC030; (*RFC5289*)
  TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256         = 0xC031; (*RFC5289*)
  TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384         = 0xC032; (*RFC5289*)
  TLS_ECDHE_PSK_WITH_RC4_128_SHA               = 0xC033; (*RFC5489*)(*RFC6347*)
  TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA          = 0xC034; (*RFC5489*)
  TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA           = 0xC035; (*RFC5489*)
  TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA           = 0xC036; (*RFC5489*)
  TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256        = 0xC037; (*RFC5489*)
  TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384        = 0xC038; (*RFC5489*)
  TLS_ECDHE_PSK_WITH_NULL_SHA                  = 0xC039; (*RFC5489*)
  TLS_ECDHE_PSK_WITH_NULL_SHA256               = 0xC03A; (*RFC5489*)
  TLS_ECDHE_PSK_WITH_NULL_SHA384               = 0xC03B; (*RFC5489*)
  TLS_RSA_WITH_ARIA_128_CBC_SHA256             = 0xC03C; (*RFC6209*)
  TLS_RSA_WITH_ARIA_256_CBC_SHA384             = 0xC03D; (*RFC6209*)
  TLS_DH_DSS_WITH_ARIA_128_CBC_SHA256          = 0xC03E; (*RFC6209*)
  TLS_DH_DSS_WITH_ARIA_256_CBC_SHA384          = 0xC03F; (*RFC6209*)
  TLS_DH_RSA_WITH_ARIA_128_CBC_SHA256          = 0xC040; (*RFC6209*)
  TLS_DH_RSA_WITH_ARIA_256_CBC_SHA384          = 0xC041; (*RFC6209*)
  TLS_DHE_DSS_WITH_ARIA_128_CBC_SHA256         = 0xC042; (*RFC6209*)
  TLS_DHE_DSS_WITH_ARIA_256_CBC_SHA384         = 0xC043; (*RFC6209*)
  TLS_DHE_RSA_WITH_ARIA_128_CBC_SHA256         = 0xC044; (*RFC6209*)
  TLS_DHE_RSA_WITH_ARIA_256_CBC_SHA384         = 0xC045; (*RFC6209*)
  TLS_DH_anon_WITH_ARIA_128_CBC_SHA256         = 0xC046; (*RFC6209*)
  TLS_DH_anon_WITH_ARIA_256_CBC_SHA384         = 0xC047; (*RFC6209*)
  TLS_ECDHE_ECDSA_WITH_ARIA_128_CBC_SHA256     = 0xC048; (*RFC6209*)
  TLS_ECDHE_ECDSA_WITH_ARIA_256_CBC_SHA384     = 0xC049; (*RFC6209*)
  TLS_ECDH_ECDSA_WITH_ARIA_128_CBC_SHA256      = 0xC04A; (*RFC6209*)
  TLS_ECDH_ECDSA_WITH_ARIA_256_CBC_SHA384      = 0xC04B; (*RFC6209*)
  TLS_ECDHE_RSA_WITH_ARIA_128_CBC_SHA256       = 0xC04C; (*RFC6209*)
  TLS_ECDHE_RSA_WITH_ARIA_256_CBC_SHA384       = 0xC04D; (*RFC6209*)
  TLS_ECDH_RSA_WITH_ARIA_128_CBC_SHA256        = 0xC04E; (*RFC6209*)
  TLS_ECDH_RSA_WITH_ARIA_256_CBC_SHA384        = 0xC04F; (*RFC6209*)
  TLS_RSA_WITH_ARIA_128_GCM_SHA256             = 0xC050; (*RFC6209*)
  TLS_RSA_WITH_ARIA_256_GCM_SHA384             = 0xC051; (*RFC6209*)
  TLS_DHE_RSA_WITH_ARIA_128_GCM_SHA256         = 0xC052; (*RFC6209*)
  TLS_DHE_RSA_WITH_ARIA_256_GCM_SHA384         = 0xC053; (*RFC6209*)
  TLS_DH_RSA_WITH_ARIA_128_GCM_SHA256          = 0xC054; (*RFC6209*)
  TLS_DH_RSA_WITH_ARIA_256_GCM_SHA384          = 0xC055; (*RFC6209*)
  TLS_DHE_DSS_WITH_ARIA_128_GCM_SHA256         = 0xC056; (*RFC6209*)
  TLS_DHE_DSS_WITH_ARIA_256_GCM_SHA384         = 0xC057; (*RFC6209*)
  TLS_DH_DSS_WITH_ARIA_128_GCM_SHA256          = 0xC058; (*RFC6209*)
  TLS_DH_DSS_WITH_ARIA_256_GCM_SHA384          = 0xC059; (*RFC6209*)
  TLS_DH_anon_WITH_ARIA_128_GCM_SHA256         = 0xC05A; (*RFC6209*)
  TLS_DH_anon_WITH_ARIA_256_GCM_SHA384         = 0xC05B; (*RFC6209*)
  TLS_ECDHE_ECDSA_WITH_ARIA_128_GCM_SHA256     = 0xC05C; (*RFC6209*)
  TLS_ECDHE_ECDSA_WITH_ARIA_256_GCM_SHA384     = 0xC05D; (*RFC6209*)
  TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256      = 0xC05E; (*RFC6209*)
  TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384      = 0xC05F; (*RFC6209*)
  TLS_ECDHE_RSA_WITH_ARIA_128_GCM_SHA256       = 0xC060; (*RFC6209*)
  TLS_ECDHE_RSA_WITH_ARIA_256_GCM_SHA384       = 0xC061; (*RFC6209*)
  TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256        = 0xC062; (*RFC6209*)
  TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384        = 0xC063; (*RFC6209*)
  TLS_PSK_WITH_ARIA_128_CBC_SHA256             = 0xC064; (*RFC6209*)
  TLS_PSK_WITH_ARIA_256_CBC_SHA384             = 0xC065; (*RFC6209*)
  TLS_DHE_PSK_WITH_ARIA_128_CBC_SHA256         = 0xC066; (*RFC6209*)
  TLS_DHE_PSK_WITH_ARIA_256_CBC_SHA384         = 0xC067; (*RFC6209*)
  TLS_RSA_PSK_WITH_ARIA_128_CBC_SHA256         = 0xC068; (*RFC6209*)
  TLS_RSA_PSK_WITH_ARIA_256_CBC_SHA384         = 0xC069; (*RFC6209*)
  TLS_PSK_WITH_ARIA_128_GCM_SHA256             = 0xC06A; (*RFC6209*)
  TLS_PSK_WITH_ARIA_256_GCM_SHA384             = 0xC06B; (*RFC6209*)
  TLS_DHE_PSK_WITH_ARIA_128_GCM_SHA256         = 0xC06C; (*RFC6209*)
  TLS_DHE_PSK_WITH_ARIA_256_GCM_SHA384         = 0xC06D; (*RFC6209*)
  TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256         = 0xC06E; (*RFC6209*)
  TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384         = 0xC06F; (*RFC6209*)
  TLS_ECDHE_PSK_WITH_ARIA_128_CBC_SHA256       = 0xC070; (*RFC6209*)
  TLS_ECDHE_PSK_WITH_ARIA_256_CBC_SHA384       = 0xC071; (*RFC6209*)
  TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 = 0xC072; (*RFC6367*)
  TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 = 0xC073; (*RFC6367*)
  TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256  = 0xC074; (*RFC6367*)
  TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384  = 0xC075; (*RFC6367*)
  TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256   = 0xC076; (*RFC6367*)
  TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384   = 0xC077; (*RFC6367*)
  TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256    = 0xC078; (*RFC6367*)
  TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384    = 0xC079; (*RFC6367*)
  TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256         = 0xC07A; (*RFC6367*)
  TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384         = 0xC07B; (*RFC6367*)
  TLS_DHE_RSA_WITH_CAMELLIA_128_GCM_SHA256     = 0xC07C; (*RFC6367*)
  TLS_DHE_RSA_WITH_CAMELLIA_256_GCM_SHA384     = 0xC07D; (*RFC6367*)
  TLS_DH_RSA_WITH_CAMELLIA_128_GCM_SHA256      = 0xC07E; (*RFC6367*)
  TLS_DH_RSA_WITH_CAMELLIA_256_GCM_SHA384      = 0xC07F; (*RFC6367*)
  TLS_DHE_DSS_WITH_CAMELLIA_128_GCM_SHA256     = 0xC080; (*RFC6367*)
  TLS_DHE_DSS_WITH_CAMELLIA_256_GCM_SHA384     = 0xC081; (*RFC6367*)
  TLS_DH_DSS_WITH_CAMELLIA_128_GCM_SHA256      = 0xC082; (*RFC6367*)
  TLS_DH_DSS_WITH_CAMELLIA_256_GCM_SHA384      = 0xC083; (*RFC6367*)
  TLS_DH_anon_WITH_CAMELLIA_128_GCM_SHA256     = 0xC084; (*RFC6367*)
  TLS_DH_anon_WITH_CAMELLIA_256_GCM_SHA384     = 0xC085; (*RFC6367*)
  TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_GCM_SHA256 = 0xC086; (*RFC6367*)
  TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_GCM_SHA384 = 0xC087; (*RFC6367*)
  TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256  = 0xC088; (*RFC6367*)
  TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384  = 0xC089; (*RFC6367*)
  TLS_ECDHE_RSA_WITH_CAMELLIA_128_GCM_SHA256   = 0xC08A; (*RFC6367*)
  TLS_ECDHE_RSA_WITH_CAMELLIA_256_GCM_SHA384   = 0xC08B; (*RFC6367*)
  TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256    = 0xC08C; (*RFC6367*)
  TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384    = 0xC08D; (*RFC6367*)
  TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256         = 0xC08E; (*RFC6367*)
  TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384         = 0xC08F; (*RFC6367*)
  TLS_DHE_PSK_WITH_CAMELLIA_128_GCM_SHA256     = 0xC090; (*RFC6367*)
  TLS_DHE_PSK_WITH_CAMELLIA_256_GCM_SHA384     = 0xC091; (*RFC6367*)
  TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256     = 0xC092; (*RFC6367*)
  TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384     = 0xC093; (*RFC6367*)
  TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256         = 0xC094; (*RFC6367*)
  TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384         = 0xC095; (*RFC6367*)
  TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256     = 0xC096; (*RFC6367*)
  TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384     = 0xC097; (*RFC6367*)
  TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256     = 0xC098; (*RFC6367*)
  TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384     = 0xC099; (*RFC6367*)
  TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256   = 0xC09A; (*RFC6367*)
  TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384   = 0xC09B; (*RFC6367*)
  TLS_RSA_WITH_AES_128_CCM                     = 0xC09C; (*RFC6655*)
  TLS_RSA_WITH_AES_256_CCM                     = 0xC09D; (*RFC6655*)
  TLS_DHE_RSA_WITH_AES_128_CCM                 = 0xC09E; (*RFC6655*)
  TLS_DHE_RSA_WITH_AES_256_CCM                 = 0xC09F; (*RFC6655*)
  TLS_RSA_WITH_AES_128_CCM_8                   = 0xC0A0; (*RFC6655*)
  TLS_RSA_WITH_AES_256_CCM_8                   = 0xC0A1; (*RFC6655*)
  TLS_DHE_RSA_WITH_AES_128_CCM_8               = 0xC0A2; (*RFC6655*)
  TLS_DHE_RSA_WITH_AES_256_CCM_8               = 0xC0A3; (*RFC6655*)
  TLS_PSK_WITH_AES_128_CCM                     = 0xC0A4; (*RFC6655*)
  TLS_PSK_WITH_AES_256_CCM                     = 0xC0A5; (*RFC6655*)
  TLS_DHE_PSK_WITH_AES_128_CCM                 = 0xC0A6; (*RFC6655*)
  TLS_DHE_PSK_WITH_AES_256_CCM                 = 0xC0A7; (*RFC6655*)
  TLS_PSK_WITH_AES_128_CCM_8                   = 0xC0A8; (*RFC6655*)
  TLS_PSK_WITH_AES_256_CCM_8                   = 0xC0A9; (*RFC6655*)
  TLS_PSK_DHE_WITH_AES_128_CCM_8               = 0xC0AA; (*RFC6655*)
  TLS_PSK_DHE_WITH_AES_256_CCM_8               = 0xC0AB; (*RFC6655*)
} as uint16_t

let get_kex_enc_hash
    : ciphersuite ->
      (key_exchange_algorithm * encryption_algorithm * hash_algorithm)
  = function
  | TLS_NULL_WITH_NULL_NULL                      -> (NULL, NULL, NULL)
  | TLS_RSA_WITH_NULL_MD5                        -> (RSA, NULL, MD5)
  | TLS_RSA_WITH_NULL_SHA                        -> (RSA, NULL, SHA)
  | TLS_RSA_EXPORT_WITH_RC4_40_MD5               -> (RSA, RC4_40, MD5)
  | TLS_RSA_WITH_RC4_128_MD5                     -> (RSA, RC4_128, MD5)
  | TLS_RSA_WITH_RC4_128_SHA                     -> (RSA, RC4_128, SHA)
  | TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5           -> (RSA, RC2_40_CBC, MD5)
  | TLS_RSA_WITH_IDEA_CBC_SHA                    -> (RSA, IDEA_CBC, SHA)
  | TLS_RSA_EXPORT_WITH_DES40_CBC_SHA            -> (RSA, DES_40_CBC, SHA)
  | TLS_RSA_WITH_DES_CBC_SHA                     -> (RSA, DES_CBC, SHA)
  | TLS_RSA_WITH_3DES_EDE_CBC_SHA                -> (RSA, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA         -> (DH_DSS, DES_40_CBC, SHA)
  | TLS_DH_DSS_WITH_DES_CBC_SHA                  -> (DH_DSS, DES_CBC, SHA)
  | TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA             -> (DH_DSS, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA         -> (DH_RSA, DES_40_CBC, SHA)
  | TLS_DH_RSA_WITH_DES_CBC_SHA                  -> (DH_RSA, DES_CBC, SHA)
  | TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA             -> (DH_RSA, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA        -> (DHE_DSS, DES_40_CBC, SHA)
  | TLS_DHE_DSS_WITH_DES_CBC_SHA                 -> (DHE_DSS, DES_CBC, SHA)
  | TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA            -> (DHE_DSS, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA        -> (DHE_RSA, DES_40_CBC, SHA)
  | TLS_DHE_RSA_WITH_DES_CBC_SHA                 -> (DHE_RSA, DES_CBC, SHA)
  | TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA            -> (DHE_RSA, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_DH_anon_EXPORT_WITH_RC4_40_MD5           -> (DH_anon, RC4_40, MD5)
  | TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA        -> (DH_anon, DES_40_CBC, SHA)
  | TLS_DH_anon_WITH_RC4_128_MD5                 -> (DH_anon, RC4_128, MD5)
  | TLS_DH_anon_WITH_DES_CBC_SHA                 -> (DH_anon, DES_CBC, SHA)
  | TLS_DH_anon_WITH_3DES_EDE_CBC_SHA            -> (DH_anon, TRIPLE_DES_EDE_CBC, SHA)
  | RESERVED_SSL3_1                              -> (NULL, NULL, NULL)
  | RESERVED_SSL3_2                              -> (NULL, NULL, NULL)
  | TLS_KRB5_WITH_DES_CBC_SHA                    -> (KRB5, DES_CBC, SHA)
  | TLS_KRB5_WITH_3DES_EDE_CBC_SHA               -> (KRB5, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_KRB5_WITH_RC4_128_SHA                    -> (KRB5, RC4_128, SHA)
  | TLS_KRB5_WITH_IDEA_CBC_SHA                   -> (KRB5, IDEA_CBC, SHA)
  | TLS_KRB5_WITH_DES_CBC_MD5                    -> (KRB5, DES_CBC, MD5)
  | TLS_KRB5_WITH_3DES_EDE_CBC_MD5               -> (KRB5, TRIPLE_DES_EDE_CBC, MD5)
  | TLS_KRB5_WITH_RC4_128_MD5                    -> (KRB5, RC4_128, MD5)
  | TLS_KRB5_WITH_IDEA_CBC_MD5                   -> (KRB5, IDEA_CBC, MD5)
  | TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA          -> (KRB5, DES_40_CBC, SHA)
  | TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA          -> (KRB5, RC2_40_CBC, SHA)
  | TLS_KRB5_EXPORT_WITH_RC4_40_SHA              -> (KRB5, RC4_40, SHA)
  | TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5          -> (KRB5, DES_40_CBC, MD5)
  | TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5          -> (KRB5, RC2_40_CBC, MD5)
  | TLS_KRB5_EXPORT_WITH_RC4_40_MD5              -> (KRB5, RC4_40, MD5)
  | TLS_PSK_WITH_NULL_SHA                        -> (PSK, NULL, SHA)
  | TLS_DHE_PSK_WITH_NULL_SHA                    -> (DHE_PSK, NULL, SHA)
  | TLS_RSA_PSK_WITH_NULL_SHA                    -> (RSA_PSK, NULL, SHA)
  | TLS_RSA_WITH_AES_128_CBC_SHA                 -> (RSA, AES_128_CBC, SHA)
  | TLS_DH_DSS_WITH_AES_128_CBC_SHA              -> (DH_DSS, AES_128_CBC, SHA)
  | TLS_DH_RSA_WITH_AES_128_CBC_SHA              -> (DH_RSA, AES_128_CBC, SHA)
  | TLS_DHE_DSS_WITH_AES_128_CBC_SHA             -> (DHE_DSS, AES_128_CBC, SHA)
  | TLS_DHE_RSA_WITH_AES_128_CBC_SHA             -> (DHE_RSA, AES_128_CBC, SHA)
  | TLS_DH_anon_WITH_AES_128_CBC_SHA             -> (DH_anon, AES_128_CBC, SHA)
  | TLS_RSA_WITH_AES_256_CBC_SHA                 -> (RSA, AES_256_CBC, SHA)
  | TLS_DH_DSS_WITH_AES_256_CBC_SHA              -> (DH_DSS, AES_256_CBC, SHA)
  | TLS_DH_RSA_WITH_AES_256_CBC_SHA              -> (DH_RSA, AES_256_CBC, SHA)
  | TLS_DHE_DSS_WITH_AES_256_CBC_SHA             -> (DHE_DSS, AES_256_CBC, SHA)
  | TLS_DHE_RSA_WITH_AES_256_CBC_SHA             -> (DHE_RSA, AES_256_CBC, SHA)
  | TLS_DH_anon_WITH_AES_256_CBC_SHA             -> (DH_anon, AES_256_CBC, SHA)
  | TLS_RSA_WITH_NULL_SHA256                     -> (RSA, NULL, SHA256)
  | TLS_RSA_WITH_AES_128_CBC_SHA256              -> (RSA, AES_128_CBC, SHA256)
  | TLS_RSA_WITH_AES_256_CBC_SHA256              -> (RSA, AES_256_CBC, SHA256)
  | TLS_DH_DSS_WITH_AES_128_CBC_SHA256           -> (DH_DSS, AES_128_CBC, SHA256)
  | TLS_DH_RSA_WITH_AES_128_CBC_SHA256           -> (DH_RSA, AES_128_CBC, SHA256)
  | TLS_DHE_DSS_WITH_AES_128_CBC_SHA256          -> (DHE_DSS, AES_128_CBC, SHA256)
  | TLS_RSA_WITH_CAMELLIA_128_CBC_SHA            -> (RSA, CAMELLIA_128_CBC, SHA)
  | TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA         -> (DH_DSS, CAMELLIA_128_CBC, SHA)
  | TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA         -> (DH_RSA, CAMELLIA_128_CBC, SHA)
  | TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA        -> (DHE_DSS, CAMELLIA_128_CBC, SHA)
  | TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA        -> (DHE_RSA, CAMELLIA_128_CBC, SHA)
  | TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA        -> (DH_anon, CAMELLIA_128_CBC, SHA)
  | TLS_DHE_RSA_WITH_AES_128_CBC_SHA256          -> (DHE_RSA, AES_128_CBC, SHA256)
  | TLS_DH_DSS_WITH_AES_256_CBC_SHA256           -> (DH_DSS, AES_256_CBC, SHA256)
  | TLS_DH_RSA_WITH_AES_256_CBC_SHA256           -> (DH_RSA, AES_256_CBC, SHA256)
  | TLS_DHE_DSS_WITH_AES_256_CBC_SHA256          -> (DHE_DSS, AES_256_CBC, SHA256)
  | TLS_DHE_RSA_WITH_AES_256_CBC_SHA256          -> (DHE_RSA, AES_256_CBC, SHA256)
  | TLS_DH_anon_WITH_AES_128_CBC_SHA256          -> (DH_anon, AES_128_CBC, SHA256)
  | TLS_DH_anon_WITH_AES_256_CBC_SHA256          -> (DH_anon, AES_256_CBC, SHA256)
  | TLS_RSA_WITH_CAMELLIA_256_CBC_SHA            -> (RSA, CAMELLIA_256_CBC, SHA)
  | TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA         -> (DH_DSS, CAMELLIA_256_CBC, SHA)
  | TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA         -> (DH_RSA, CAMELLIA_256_CBC, SHA)
  | TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA        -> (DHE_DSS, CAMELLIA_256_CBC, SHA)
  | TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA        -> (DHE_RSA, CAMELLIA_256_CBC, SHA)
  | TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA        -> (DH_anon, CAMELLIA_256_CBC, SHA)
  | TLS_PSK_WITH_RC4_128_SHA                     -> (PSK, RC4_128, SHA)
  | TLS_PSK_WITH_3DES_EDE_CBC_SHA                -> (PSK, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_PSK_WITH_AES_128_CBC_SHA                 -> (PSK, AES_128_CBC, SHA)
  | TLS_PSK_WITH_AES_256_CBC_SHA                 -> (PSK, AES_256_CBC, SHA)
  | TLS_DHE_PSK_WITH_RC4_128_SHA                 -> (DHE_PSK, RC4_128, SHA)
  | TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA            -> (DHE_PSK, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_DHE_PSK_WITH_AES_128_CBC_SHA             -> (DHE_PSK, AES_128_CBC, SHA)
  | TLS_DHE_PSK_WITH_AES_256_CBC_SHA             -> (DHE_PSK, AES_256_CBC, SHA)
  | TLS_RSA_PSK_WITH_RC4_128_SHA                 -> (RSA_PSK, RC4_128, SHA)
  | TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA            -> (RSA_PSK, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_RSA_PSK_WITH_AES_128_CBC_SHA             -> (RSA_PSK, AES_128_CBC, SHA)
  | TLS_RSA_PSK_WITH_AES_256_CBC_SHA             -> (RSA_PSK, AES_256_CBC, SHA)
  | TLS_RSA_WITH_SEED_CBC_SHA                    -> (RSA, SEED_CBC, SHA)
  | TLS_DH_DSS_WITH_SEED_CBC_SHA                 -> (DH_DSS, SEED_CBC, SHA)
  | TLS_DH_RSA_WITH_SEED_CBC_SHA                 -> (DH_RSA, SEED_CBC, SHA)
  | TLS_DHE_DSS_WITH_SEED_CBC_SHA                -> (DHE_DSS, SEED_CBC, SHA)
  | TLS_DHE_RSA_WITH_SEED_CBC_SHA                -> (DHE_RSA, SEED_CBC, SHA)
  | TLS_DH_anon_WITH_SEED_CBC_SHA                -> (DH_anon, SEED_CBC, SHA)
  | TLS_RSA_WITH_AES_128_GCM_SHA256              -> (RSA, AES_128_GCM, SHA256)
  | TLS_RSA_WITH_AES_256_GCM_SHA384              -> (RSA, AES_256_GCM, SHA384)
  | TLS_DHE_RSA_WITH_AES_128_GCM_SHA256          -> (DHE_RSA, AES_128_GCM, SHA256)
  | TLS_DHE_RSA_WITH_AES_256_GCM_SHA384          -> (DHE_RSA, AES_256_GCM, SHA384)
  | TLS_DH_RSA_WITH_AES_128_GCM_SHA256           -> (DH_RSA, AES_128_GCM, SHA256)
  | TLS_DH_RSA_WITH_AES_256_GCM_SHA384           -> (DH_RSA, AES_256_GCM, SHA384)
  | TLS_DHE_DSS_WITH_AES_128_GCM_SHA256          -> (DHE_DSS, AES_128_GCM, SHA256)
  | TLS_DHE_DSS_WITH_AES_256_GCM_SHA384          -> (DHE_DSS, AES_256_GCM, SHA384)
  | TLS_DH_DSS_WITH_AES_128_GCM_SHA256           -> (DH_DSS, AES_128_GCM, SHA256)
  | TLS_DH_DSS_WITH_AES_256_GCM_SHA384           -> (DH_DSS, AES_256_GCM, SHA384)
  | TLS_DH_anon_WITH_AES_128_GCM_SHA256          -> (DH_anon, AES_128_GCM, SHA256)
  | TLS_DH_anon_WITH_AES_256_GCM_SHA384          -> (DH_anon, AES_256_GCM, SHA384)
  | TLS_PSK_WITH_AES_128_GCM_SHA256              -> (PSK, AES_128_GCM, SHA256)
  | TLS_PSK_WITH_AES_256_GCM_SHA384              -> (PSK, AES_256_GCM, SHA384)
  | TLS_DHE_PSK_WITH_AES_128_GCM_SHA256          -> (DHE_PSK, AES_128_GCM, SHA256)
  | TLS_DHE_PSK_WITH_AES_256_GCM_SHA384          -> (DHE_PSK, AES_256_GCM, SHA384)
  | TLS_RSA_PSK_WITH_AES_128_GCM_SHA256          -> (RSA_PSK, AES_128_GCM, SHA256)
  | TLS_RSA_PSK_WITH_AES_256_GCM_SHA384          -> (RSA_PSK, AES_256_GCM, SHA384)
  | TLS_PSK_WITH_AES_128_CBC_SHA256              -> (PSK, AES_128_CBC, SHA256)
  | TLS_PSK_WITH_AES_256_CBC_SHA384              -> (PSK, AES_256_CBC, SHA384)
  | TLS_PSK_WITH_NULL_SHA256                     -> (PSK, NULL, SHA256)
  | TLS_PSK_WITH_NULL_SHA384                     -> (PSK, NULL, SHA384)
  | TLS_DHE_PSK_WITH_AES_128_CBC_SHA256          -> (DHE_PSK, AES_128_CBC, SHA256)
  | TLS_DHE_PSK_WITH_AES_256_CBC_SHA384          -> (DHE_PSK, AES_256_CBC, SHA384)
  | TLS_DHE_PSK_WITH_NULL_SHA256                 -> (DHE_PSK, NULL, SHA256)
  | TLS_DHE_PSK_WITH_NULL_SHA384                 -> (DHE_PSK, NULL, SHA384)
  | TLS_RSA_PSK_WITH_AES_128_CBC_SHA256          -> (RSA_PSK, AES_128_CBC, SHA256)
  | TLS_RSA_PSK_WITH_AES_256_CBC_SHA384          -> (RSA_PSK, AES_256_CBC, SHA384)
  | TLS_RSA_PSK_WITH_NULL_SHA256                 -> (RSA_PSK, NULL, SHA256)
  | TLS_RSA_PSK_WITH_NULL_SHA384                 -> (RSA_PSK, NULL, SHA384)
  | TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256         -> (RSA, CAMELLIA_128_CBC, SHA256)
  | TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256      -> (DH_DSS, CAMELLIA_128_CBC, SHA256)
  | TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256      -> (DH_RSA, CAMELLIA_128_CBC, SHA256)
  | TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256     -> (DHE_DSS, CAMELLIA_128_CBC, SHA256)
  | TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256     -> (DHE_RSA, CAMELLIA_128_CBC, SHA256)
  | TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256     -> (DH_anon, CAMELLIA_128_CBC, SHA256)
  | TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256         -> (RSA, CAMELLIA_256_CBC, SHA256)
  | TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256      -> (DH_DSS, CAMELLIA_256_CBC, SHA256)
  | TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256      -> (DH_RSA, CAMELLIA_256_CBC, SHA256)
  | TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256     -> (DHE_DSS, CAMELLIA_256_CBC, SHA256)
  | TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256     -> (DHE_RSA, CAMELLIA_256_CBC, SHA256)
  | TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA256     -> (DH_anon, CAMELLIA_256_CBC, SHA256)
  | TLS_EMPTY_RENEGOTIATION_INFO_SCSV            -> (NULL, NULL, NULL)
  | TLS_ECDH_ECDSA_WITH_NULL_SHA                 -> (ECDH_ECDSA, NULL, SHA)
  | TLS_ECDH_ECDSA_WITH_RC4_128_SHA              -> (ECDH_ECDSA, RC4_128, SHA)
  | TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA         -> (ECDH_ECDSA, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA          -> (ECDH_ECDSA, AES_128_CBC, SHA)
  | TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA          -> (ECDH_ECDSA, AES_256_CBC, SHA)
  | TLS_ECDHE_ECDSA_WITH_NULL_SHA                -> (ECDHE_ECDSA, NULL, SHA)
  | TLS_ECDHE_ECDSA_WITH_RC4_128_SHA             -> (ECDHE_ECDSA, RC4_128, SHA)
  | TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA        -> (ECDHE_ECDSA, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA         -> (ECDHE_ECDSA, AES_128_CBC, SHA)
  | TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA         -> (ECDHE_ECDSA, AES_256_CBC, SHA)
  | TLS_ECDH_RSA_WITH_NULL_SHA                   -> (ECDH_RSA, NULL, SHA)
  | TLS_ECDH_RSA_WITH_RC4_128_SHA                -> (ECDH_RSA, RC4_128, SHA)
  | TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA           -> (ECDH_RSA, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_ECDH_RSA_WITH_AES_128_CBC_SHA            -> (ECDH_RSA, AES_128_CBC, SHA)
  | TLS_ECDH_RSA_WITH_AES_256_CBC_SHA            -> (ECDH_RSA, AES_256_CBC, SHA)
  | TLS_ECDHE_RSA_WITH_NULL_SHA                  -> (ECDHE_RSA, NULL, SHA)
  | TLS_ECDHE_RSA_WITH_RC4_128_SHA               -> (ECDHE_RSA, RC4_128, SHA)
  | TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA          -> (ECDHE_RSA, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA           -> (ECDHE_RSA, AES_128_CBC, SHA)
  | TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA           -> (ECDHE_RSA, AES_256_CBC, SHA)
  | TLS_ECDH_anon_WITH_NULL_SHA                  -> (ECDH_anon, NULL, SHA)
  | TLS_ECDH_anon_WITH_RC4_128_SHA               -> (ECDH_anon, RC4_128, SHA)
  | TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA          -> (ECDH_anon, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_ECDH_anon_WITH_AES_128_CBC_SHA           -> (ECDH_anon, AES_128_CBC, SHA)
  | TLS_ECDH_anon_WITH_AES_256_CBC_SHA           -> (ECDH_anon, AES_256_CBC, SHA)
  | TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA            -> (SRP_SHA, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA        -> (SRP_SHA_RSA, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA        -> (SRP_SHA_DSS, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_SRP_SHA_WITH_AES_128_CBC_SHA             -> (SRP_SHA, AES_128_CBC, SHA)
  | TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA         -> (SRP_SHA_RSA, AES_128_CBC, SHA)
  | TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA         -> (SRP_SHA_DSS, AES_128_CBC, SHA)
  | TLS_SRP_SHA_WITH_AES_256_CBC_SHA             -> (SRP_SHA, AES_256_CBC, SHA)
  | TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA         -> (SRP_SHA_RSA, AES_256_CBC, SHA)
  | TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA         -> (SRP_SHA_DSS, AES_256_CBC, SHA)
  | TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256      -> (ECDHE_ECDSA, AES_128_CBC, SHA256)
  | TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384      -> (ECDHE_ECDSA, AES_256_CBC, SHA384)
  | TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256       -> (ECDH_ECDSA, AES_128_CBC, SHA256)
  | TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384       -> (ECDH_ECDSA, AES_256_CBC, SHA384)
  | TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256        -> (ECDHE_RSA, AES_128_CBC, SHA256)
  | TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384        -> (ECDHE_RSA, AES_256_CBC, SHA384)
  | TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256         -> (ECDH_RSA, AES_128_CBC, SHA256)
  | TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384         -> (ECDH_RSA, AES_256_CBC, SHA384)
  | TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256      -> (ECDHE_ECDSA, AES_128_GCM, SHA256)
  | TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384      -> (ECDHE_ECDSA, AES_256_GCM, SHA384)
  | TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256       -> (ECDH_ECDSA, AES_128_GCM, SHA256)
  | TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384       -> (ECDH_ECDSA, AES_256_GCM, SHA384)
  | TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256        -> (ECDHE_RSA, AES_128_GCM, SHA256)
  | TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384        -> (ECDHE_RSA, AES_256_GCM, SHA384)
  | TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256         -> (ECDH_RSA, AES_128_GCM, SHA256)
  | TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384         -> (ECDH_RSA, AES_256_GCM, SHA384)
  | TLS_ECDHE_PSK_WITH_RC4_128_SHA               -> (ECDHE_PSK, RC4_128, SHA)
  | TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA          -> (ECDHE_PSK, TRIPLE_DES_EDE_CBC, SHA)
  | TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA           -> (ECDHE_PSK, AES_128_CBC, SHA)
  | TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA           -> (ECDHE_PSK, AES_256_CBC, SHA)
  | TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256        -> (ECDHE_PSK, AES_128_CBC, SHA256)
  | TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384        -> (ECDHE_PSK, AES_256_CBC, SHA384)
  | TLS_ECDHE_PSK_WITH_NULL_SHA                  -> (ECDHE_PSK, NULL, SHA)
  | TLS_ECDHE_PSK_WITH_NULL_SHA256               -> (ECDHE_PSK, NULL, SHA256)
  | TLS_ECDHE_PSK_WITH_NULL_SHA384               -> (ECDHE_PSK, NULL, SHA384)
  | TLS_RSA_WITH_ARIA_128_CBC_SHA256             -> (RSA, ARIA_128_CBC, SHA256)
  | TLS_RSA_WITH_ARIA_256_CBC_SHA384             -> (RSA, ARIA_256_CBC, SHA384)
  | TLS_DH_DSS_WITH_ARIA_128_CBC_SHA256          -> (DH_DSS, ARIA_128_CBC, SHA256)
  | TLS_DH_DSS_WITH_ARIA_256_CBC_SHA384          -> (DH_DSS, ARIA_256_CBC, SHA384)
  | TLS_DH_RSA_WITH_ARIA_128_CBC_SHA256          -> (DH_RSA, ARIA_128_CBC, SHA256)
  | TLS_DH_RSA_WITH_ARIA_256_CBC_SHA384          -> (DH_RSA, ARIA_256_CBC, SHA384)
  | TLS_DHE_DSS_WITH_ARIA_128_CBC_SHA256         -> (DHE_DSS, ARIA_128_CBC, SHA256)
  | TLS_DHE_DSS_WITH_ARIA_256_CBC_SHA384         -> (DHE_DSS, ARIA_256_CBC, SHA384)
  | TLS_DHE_RSA_WITH_ARIA_128_CBC_SHA256         -> (DHE_RSA, ARIA_128_CBC, SHA256)
  | TLS_DHE_RSA_WITH_ARIA_256_CBC_SHA384         -> (DHE_RSA, ARIA_256_CBC, SHA384)
  | TLS_DH_anon_WITH_ARIA_128_CBC_SHA256         -> (DH_anon, ARIA_128_CBC, SHA256)
  | TLS_DH_anon_WITH_ARIA_256_CBC_SHA384         -> (DH_anon, ARIA_256_CBC, SHA384)
  | TLS_ECDHE_ECDSA_WITH_ARIA_128_CBC_SHA256     -> (ECDHE_ECDSA, ARIA_128_CBC, SHA256)
  | TLS_ECDHE_ECDSA_WITH_ARIA_256_CBC_SHA384     -> (ECDHE_ECDSA, ARIA_256_CBC, SHA384)
  | TLS_ECDH_ECDSA_WITH_ARIA_128_CBC_SHA256      -> (ECDH_ECDSA, ARIA_128_CBC, SHA256)
  | TLS_ECDH_ECDSA_WITH_ARIA_256_CBC_SHA384      -> (ECDH_ECDSA, ARIA_256_CBC, SHA384)
  | TLS_ECDHE_RSA_WITH_ARIA_128_CBC_SHA256       -> (ECDHE_RSA, ARIA_128_CBC, SHA256)
  | TLS_ECDHE_RSA_WITH_ARIA_256_CBC_SHA384       -> (ECDHE_RSA, ARIA_256_CBC, SHA384)
  | TLS_ECDH_RSA_WITH_ARIA_128_CBC_SHA256        -> (ECDH_RSA, ARIA_128_CBC, SHA256)
  | TLS_ECDH_RSA_WITH_ARIA_256_CBC_SHA384        -> (ECDH_RSA, ARIA_256_CBC, SHA384)
  | TLS_RSA_WITH_ARIA_128_GCM_SHA256             -> (RSA, ARIA_128_GCM, SHA256)
  | TLS_RSA_WITH_ARIA_256_GCM_SHA384             -> (RSA, ARIA_256_GCM, SHA384)
  | TLS_DHE_RSA_WITH_ARIA_128_GCM_SHA256         -> (DHE_RSA, ARIA_128_GCM, SHA256)
  | TLS_DHE_RSA_WITH_ARIA_256_GCM_SHA384         -> (DHE_RSA, ARIA_256_GCM, SHA384)
  | TLS_DH_RSA_WITH_ARIA_128_GCM_SHA256          -> (DH_RSA, ARIA_128_GCM, SHA256)
  | TLS_DH_RSA_WITH_ARIA_256_GCM_SHA384          -> (DH_RSA, ARIA_256_GCM, SHA384)
  | TLS_DHE_DSS_WITH_ARIA_128_GCM_SHA256         -> (DHE_DSS, ARIA_128_GCM, SHA256)
  | TLS_DHE_DSS_WITH_ARIA_256_GCM_SHA384         -> (DHE_DSS, ARIA_256_GCM, SHA384)
  | TLS_DH_DSS_WITH_ARIA_128_GCM_SHA256          -> (DH_DSS, ARIA_128_GCM, SHA256)
  | TLS_DH_DSS_WITH_ARIA_256_GCM_SHA384          -> (DH_DSS, ARIA_256_GCM, SHA384)
  | TLS_DH_anon_WITH_ARIA_128_GCM_SHA256         -> (DH_anon, ARIA_128_GCM, SHA256)
  | TLS_DH_anon_WITH_ARIA_256_GCM_SHA384         -> (DH_anon, ARIA_256_GCM, SHA384)
  | TLS_ECDHE_ECDSA_WITH_ARIA_128_GCM_SHA256     -> (ECDHE_ECDSA, ARIA_128_GCM, SHA256)
  | TLS_ECDHE_ECDSA_WITH_ARIA_256_GCM_SHA384     -> (ECDHE_ECDSA, ARIA_256_GCM, SHA384)
  | TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256      -> (ECDH_ECDSA, ARIA_128_GCM, SHA256)
  | TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384      -> (ECDH_ECDSA, ARIA_256_GCM, SHA384)
  | TLS_ECDHE_RSA_WITH_ARIA_128_GCM_SHA256       -> (ECDHE_RSA, ARIA_128_GCM, SHA256)
  | TLS_ECDHE_RSA_WITH_ARIA_256_GCM_SHA384       -> (ECDHE_RSA, ARIA_256_GCM, SHA384)
  | TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256        -> (ECDH_RSA, ARIA_128_GCM, SHA256)
  | TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384        -> (ECDH_RSA, ARIA_256_GCM, SHA384)
  | TLS_PSK_WITH_ARIA_128_CBC_SHA256             -> (PSK, ARIA_128_CBC, SHA256)
  | TLS_PSK_WITH_ARIA_256_CBC_SHA384             -> (PSK, ARIA_256_CBC, SHA384)
  | TLS_DHE_PSK_WITH_ARIA_128_CBC_SHA256         -> (DHE_PSK, ARIA_128_CBC, SHA256)
  | TLS_DHE_PSK_WITH_ARIA_256_CBC_SHA384         -> (DHE_PSK, ARIA_256_CBC, SHA384)
  | TLS_RSA_PSK_WITH_ARIA_128_CBC_SHA256         -> (RSA_PSK, ARIA_128_CBC, SHA256)
  | TLS_RSA_PSK_WITH_ARIA_256_CBC_SHA384         -> (RSA_PSK, ARIA_256_CBC, SHA384)
  | TLS_PSK_WITH_ARIA_128_GCM_SHA256             -> (PSK, ARIA_128_GCM, SHA256)
  | TLS_PSK_WITH_ARIA_256_GCM_SHA384             -> (PSK, ARIA_256_GCM, SHA384)
  | TLS_DHE_PSK_WITH_ARIA_128_GCM_SHA256         -> (DHE_PSK, ARIA_128_GCM, SHA256)
  | TLS_DHE_PSK_WITH_ARIA_256_GCM_SHA384         -> (DHE_PSK, ARIA_256_GCM, SHA384)
  | TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256         -> (RSA_PSK, ARIA_128_GCM, SHA256)
  | TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384         -> (RSA_PSK, ARIA_256_GCM, SHA384)
  | TLS_ECDHE_PSK_WITH_ARIA_128_CBC_SHA256       -> (ECDHE_PSK, ARIA_128_CBC, SHA256)
  | TLS_ECDHE_PSK_WITH_ARIA_256_CBC_SHA384       -> (ECDHE_PSK, ARIA_256_CBC, SHA384)
  | TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 -> (ECDHE_ECDSA, CAMELLIA_128_CBC, SHA256)
  | TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 -> (ECDHE_ECDSA, CAMELLIA_256_CBC, SHA384)
  | TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256  -> (ECDH_ECDSA, CAMELLIA_128_CBC, SHA256)
  | TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384  -> (ECDH_ECDSA, CAMELLIA_256_CBC, SHA384)
  | TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256   -> (ECDHE_RSA, CAMELLIA_128_CBC, SHA256)
  | TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384   -> (ECDHE_RSA, CAMELLIA_256_CBC, SHA384)
  | TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256    -> (ECDH_RSA, CAMELLIA_128_CBC, SHA256)
  | TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384    -> (ECDH_RSA, CAMELLIA_256_CBC, SHA384)
  | TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256         -> (RSA, CAMELLIA_128_GCM, SHA256)
  | TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384         -> (RSA, CAMELLIA_256_GCM, SHA384)
  | TLS_DHE_RSA_WITH_CAMELLIA_128_GCM_SHA256     -> (DHE_RSA, CAMELLIA_128_GCM, SHA256)
  | TLS_DHE_RSA_WITH_CAMELLIA_256_GCM_SHA384     -> (DHE_RSA, CAMELLIA_256_GCM, SHA384)
  | TLS_DH_RSA_WITH_CAMELLIA_128_GCM_SHA256      -> (DH_RSA, CAMELLIA_128_GCM, SHA256)
  | TLS_DH_RSA_WITH_CAMELLIA_256_GCM_SHA384      -> (DH_RSA, CAMELLIA_256_GCM, SHA384)
  | TLS_DHE_DSS_WITH_CAMELLIA_128_GCM_SHA256     -> (DHE_DSS, CAMELLIA_128_GCM, SHA256)
  | TLS_DHE_DSS_WITH_CAMELLIA_256_GCM_SHA384     -> (DHE_DSS, CAMELLIA_256_GCM, SHA384)
  | TLS_DH_DSS_WITH_CAMELLIA_128_GCM_SHA256      -> (DH_DSS, CAMELLIA_128_GCM, SHA256)
  | TLS_DH_DSS_WITH_CAMELLIA_256_GCM_SHA384      -> (DH_DSS, CAMELLIA_256_GCM, SHA384)
  | TLS_DH_anon_WITH_CAMELLIA_128_GCM_SHA256     -> (DH_anon, CAMELLIA_128_GCM, SHA256)
  | TLS_DH_anon_WITH_CAMELLIA_256_GCM_SHA384     -> (DH_anon, CAMELLIA_256_GCM, SHA384)
  | TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_GCM_SHA256 -> (ECDHE_ECDSA, CAMELLIA_128_GCM, SHA256)
  | TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_GCM_SHA384 -> (ECDHE_ECDSA, CAMELLIA_256_GCM, SHA384)
  | TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256  -> (ECDH_ECDSA, CAMELLIA_128_GCM, SHA256)
  | TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384  -> (ECDH_ECDSA, CAMELLIA_256_GCM, SHA384)
  | TLS_ECDHE_RSA_WITH_CAMELLIA_128_GCM_SHA256   -> (ECDHE_RSA, CAMELLIA_128_GCM, SHA256)
  | TLS_ECDHE_RSA_WITH_CAMELLIA_256_GCM_SHA384   -> (ECDHE_RSA, CAMELLIA_256_GCM, SHA384)
  | TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256    -> (ECDH_RSA, CAMELLIA_128_GCM, SHA256)
  | TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384    -> (ECDH_RSA, CAMELLIA_256_GCM, SHA384)
  | TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256         -> (PSK, CAMELLIA_128_GCM, SHA256)
  | TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384         -> (PSK, CAMELLIA_256_GCM, SHA384)
  | TLS_DHE_PSK_WITH_CAMELLIA_128_GCM_SHA256     -> (DHE_PSK, CAMELLIA_128_GCM, SHA256)
  | TLS_DHE_PSK_WITH_CAMELLIA_256_GCM_SHA384     -> (DHE_PSK, CAMELLIA_256_GCM, SHA384)
  | TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256     -> (RSA_PSK, CAMELLIA_128_GCM, SHA256)
  | TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384     -> (RSA_PSK, CAMELLIA_256_GCM, SHA384)
  | TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256         -> (PSK, CAMELLIA_128_CBC, SHA256)
  | TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384         -> (PSK, CAMELLIA_256_CBC, SHA384)
  | TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256     -> (DHE_PSK, CAMELLIA_128_CBC, SHA256)
  | TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384     -> (DHE_PSK, CAMELLIA_256_CBC, SHA384)
  | TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256     -> (RSA_PSK, CAMELLIA_128_CBC, SHA256)
  | TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384     -> (RSA_PSK, CAMELLIA_256_CBC, SHA384)
  | TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256   -> (ECDHE_PSK, CAMELLIA_128_CBC, SHA256)
  | TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384   -> (ECDHE_PSK, CAMELLIA_256_CBC, SHA384)
  | TLS_RSA_WITH_AES_128_CCM                     -> (RSA, AES_128_CCM, NULL)
  | TLS_RSA_WITH_AES_256_CCM                     -> (RSA, AES_256_CCM, NULL)
  | TLS_DHE_RSA_WITH_AES_128_CCM                 -> (DHE_RSA, AES_128_CCM, NULL)
  | TLS_DHE_RSA_WITH_AES_256_CCM                 -> (DHE_RSA, AES_256_CCM, NULL)
  | TLS_RSA_WITH_AES_128_CCM_8                   -> (RSA, AES_128_CCM_8, NULL)
  | TLS_RSA_WITH_AES_256_CCM_8                   -> (RSA, AES_256_CCM_8, NULL)
  | TLS_DHE_RSA_WITH_AES_128_CCM_8               -> (DHE_RSA, AES_128_CCM_8, NULL)
  | TLS_DHE_RSA_WITH_AES_256_CCM_8               -> (DHE_RSA, AES_256_CCM_8, NULL)
  | TLS_PSK_WITH_AES_128_CCM                     -> (PSK, AES_128_CCM, NULL)
  | TLS_PSK_WITH_AES_256_CCM                     -> (PSK, AES_256_CCM, NULL)
  | TLS_DHE_PSK_WITH_AES_128_CCM                 -> (DHE_PSK, AES_128_CCM, NULL)
  | TLS_DHE_PSK_WITH_AES_256_CCM                 -> (DHE_PSK, AES_256_CCM, NULL)
  | TLS_PSK_WITH_AES_128_CCM_8                   -> (PSK, AES_128_CCM_8, NULL)
  | TLS_PSK_WITH_AES_256_CCM_8                   -> (PSK, AES_256_CCM_8, NULL)
  | TLS_PSK_DHE_WITH_AES_128_CCM_8               -> (DHE_PSK, AES_128_CCM_8, NULL)
  | TLS_PSK_DHE_WITH_AES_256_CCM_8               -> (DHE_PSK, AES_256_CCM_8, NULL)

let ciphersuite_kex c = let (k, _, _) = get_kex_enc_hash c in k
let ciphersuite_cipher c = let (_, k, _) = get_kex_enc_hash c in k
let ciphersuite_mac c = let (_, _, k) = get_kex_enc_hash c in k

let ciphersuite_cipher_mac_length c =
  let cipher = ciphersuite_cipher c in
  key_lengths cipher
